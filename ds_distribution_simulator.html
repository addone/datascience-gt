<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€DSè¬›ç¾©è³‡æ–™ã€‘ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç¢ºç‡åˆ†å¸ƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #005a9c;
            text-align: center;
        }
        .main-container {
             width: 100%;
             max-width: 850px;
        }
        .intro-box {
            background-color: #e9f5ff;
            border-left: 4px solid #007bff;
            padding: 15px 20px;
            margin: 10px 0 20px 0;
            border-radius: 0 4px 4px 0;
        }
        .container {
            width: 100%;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            margin-top: 20px;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 500;
            color: #495057;
            position: relative;
            transition: color 0.3s;
        }
        .tab-button:hover {
            color: #005a9c;
        }
        .tab-button.active {
            color: #005a9c;
            font-weight: 700;
        }
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #005a9c;
        }
        .content {
            display: none;
        }
        .content.active {
            display: block;
        }
        .content h4 {
            margin-top: 15px;
            margin-bottom: 5px;
            color: #005a9c;
            border-left: 3px solid #007bff;
            padding-left: 8px;
        }
        .content ul {
            margin-top: 5px;
            padding-left: 25px;
            list-style-type: 'ğŸ‘‰';
            padding-inline-start: 1em;
        }
        .content li {
            margin-bottom: 5px;
            padding-left: 8px;
        }
        .instruction {
            margin-top: 20px;
            font-weight: 500;
            text-align: center;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            margin-bottom: 20px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }
        .controls label {
            font-weight: 500;
        }
        .controls input[type="number"], .controls input[type="range"] {
            width: 80px;
            padding: 5px;
            border: 1px solid #ced4da;
            border-radius: 4px;
        }
        .controls button {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .controls button:hover {
            background-color: #0056b3;
        }
        .chart-container {
            position: relative;
            height: 40vh;
            width: 100%;
        }
    </style>
</head>
<body>

<div class="main-container">
    <h1>ç¢ºç‡åˆ†å¸ƒã‚’ä½“é¨“ã—ã‚ˆã†ï¼ ğŸ²</h1>
    
    <div class="intro-box">
        <h3>ãã‚‚ãã‚‚ã€Œç¢ºç‡åˆ†å¸ƒã€ã£ã¦ä½•ï¼Ÿ</h3>
        <p>
            ã€Œåˆ†å¸ƒã€ã¨èãã¨é›£ã—ãã†ã§ã™ãŒã€ã“ã‚Œã¯ç§ãŸã¡ã®èº«ã®å›ã‚Šã«ã‚ã‚‹ã€Œä¸ç¢ºã‹ã•ã€ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®ã€ã¨ã¦ã‚‚ä¾¿åˆ©ãª<strong>åœ°å›³</strong>ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚<br>
            ä¸€è¨€ã§ã„ã†ã¨ã€ã€Œ<b>ã‚ã‚‹å‡ºæ¥äº‹ã®ã€ã™ã¹ã¦ã®çµæœã¨ã€ãã‚Œãã‚Œã®çµæœãŒèµ·ã“ã‚‹ç¢ºç‡ã‚’ä¸€è¦§ã«ã—ãŸã‚‚ã®</b>ã€ã§ã™ã€‚
            ä¾‹ãˆã°ã‚µã‚¤ã‚³ãƒ­ã‚’1å›æŒ¯ã‚‹ã¨ã€èµ·ã“ã‚Šã†ã‚‹çµæœã¯ {1, 2, 3, 4, 5, 6} ã§ã€ãã‚Œãã‚Œã®ç¢ºç‡ã¯ã™ã¹ã¦ $\frac{1}{6}$ ã§ã™ã­ã€‚ã“ã‚Œã‚’ã‚°ãƒ©ãƒ•ã«ã—ãŸã‚‚ã®ãŒæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªç¢ºç‡åˆ†å¸ƒã§ã™ã€‚
        </p>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab-button active" onclick="openTab('uniform')">ä¸€æ§˜åˆ†å¸ƒ</button>
            <button class="tab-button" onclick="openTab('binomial')">äºŒé …åˆ†å¸ƒ</button>
            <button class="tab-button" onclick="openTab('normal')">æ­£è¦åˆ†å¸ƒ</button>
        </div>

        <div id="uniform" class="content active">
            <h2>ä¸€æ§˜åˆ†å¸ƒ (Uniform Distribution)</h2>
            <h4>è€ƒãˆæ–¹</h4>
            <p>ã“ã‚Œã¯ã€Œ<strong>ã™ã¹ã¦ã®çµæœãŒåŒã˜ç¢ºç‡ã§èµ·ã“ã‚‹</strong>ã€ã¨ã„ã†ã€æœ€ã‚‚å…¬å¹³ã§ã‚·ãƒ³ãƒ—ãƒ«ãªåˆ†å¸ƒã§ã™ã€‚ã©ã®ç›®ãŒå‡ºã‚„ã™ã„ã¨ã„ã†åã‚ŠãŒä¸€åˆ‡ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
            <h4>èº«è¿‘ãªä¾‹</h4>
            <ul>
                <li>ã‚µã‚¤ã‚³ãƒ­ã‚’1å›æŒ¯ã£ãŸã¨ãã«å‡ºã‚‹ç›®</li>
                <li>ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã®é‡ãŒã©ã“ã§æ­¢ã¾ã‚‹ã‹</li>
            </ul>
            <p class="instruction">ğŸ‘‡ ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã€ã‚°ãƒ©ãƒ•ã®æ£’ã®é«˜ã•ãŒæƒã£ã¦ã„ãæ§˜å­ã‚’è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚</p>
            <div class="controls">
                <button onclick="runUniform(1)">1å›æŒ¯ã‚‹</button>
                <button onclick="runUniform(100)">100å›æŒ¯ã‚‹</button>
                <button onclick="resetChart('uniform')">ãƒªã‚»ãƒƒãƒˆ</button>
                <div id="uniform-total">ç·è©¦è¡Œå›æ•°: 0</div>
            </div>
            <div class="chart-container">
                <canvas id="uniformChart"></canvas>
            </div>
        </div>

        <div id="binomial" class="content">
            <h2>äºŒé …åˆ†å¸ƒ (Binomial Distribution)</h2>
            <h4>è€ƒãˆæ–¹</h4>
            <p>ã‚³ã‚¤ãƒ³æŠ•ã’ã®ã‚ˆã†ã«ã€Œ<strong>ã€ã¯ã„ã€ã‹ã€ã„ã„ãˆã€ï¼ˆæˆåŠŸã‹å¤±æ•—ï¼‰ã®çµæœã«ãªã‚‹è©¦è¡Œã‚’ã€æ±ºã¾ã£ãŸå›æ•°ç¹°ã‚Šè¿”ã—ãŸã¨ãã®ã€æˆåŠŸå›æ•°ã€</strong>ã€ã®åˆ†å¸ƒã€‚å¤šãã®å ´åˆã€çœŸã‚“ä¸­ã®å›æ•°ãŒä¸€ç•ªèµ·ã“ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚</p>
            <h4>èº«è¿‘ãªä¾‹</h4>
            <ul>
                <li>ã‚³ã‚¤ãƒ³ã‚’10å›æŠ•ã’ã¦ã€è¡¨ãŒå‡ºãŸå›æ•°</li>
                <li>ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«é¸æ‰‹ãŒãƒ•ãƒªãƒ¼ã‚¹ãƒ­ãƒ¼ã‚’5å›æŠ•ã’ã¦ã€æˆåŠŸã—ãŸå›æ•°</li>
            </ul>
            <p class="instruction">ğŸ‘‡ ã€Œã‚³ã‚¤ãƒ³ã®æšæ•°ã€ã¨ã€Œè¡¨ã®å‡ºã‚‹ç¢ºç‡ã€ã‚’è¨­å®šã—ã¦ã€ã©ã®ã‚ˆã†ãªå½¢ã®å±±ãŒã§ãã‚‹ã‹è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
            <div class="controls">
                <label for="n-trials">ã‚³ã‚¤ãƒ³ã®æšæ•° (n):</label>
                <input type="number" id="n-trials" value="10" min="1" max="50">
                <label for="p-prob">è¡¨ã®å‡ºã‚‹ç¢ºç‡ (p):</label>
                <input type="range" id="p-prob" value="0.5" min="0" max="1" step="0.01">
                <button onclick="runBinomial()">100ã‚»ãƒƒãƒˆè©¦è¡Œ</button>
                <button onclick="resetChart('binomial')">ãƒªã‚»ãƒƒãƒˆ</button>
                <div id="binomial-total">ç·ã‚»ãƒƒãƒˆæ•°: 0</div>
            </div>
            <div class="chart-container">
                <canvas id="binomialChart"></canvas>
            </div>
        </div>

        <div id="normal" class="content">
            <h2>æ­£è¦åˆ†å¸ƒ (Normal Distribution)</h2>
            <h4>è€ƒãˆæ–¹</h4>
            <p>èº«é•·ã‚„ãƒ†ã‚¹ãƒˆã®ç‚¹æ•°ãªã©ã€è‡ªç„¶ç•Œã‚„ç¤¾ä¼šã§æœ€ã‚‚ã‚ˆãè¦‹ã‚‰ã‚Œã‚‹åˆ†å¸ƒã€‚ã€Œ<strong>å¹³å‡å€¤ã®å‘¨ã‚Šã«ãƒ‡ãƒ¼ã‚¿ãŒæœ€ã‚‚å¤šãé›†ã¾ã‚Šã€å¹³å‡ã‹ã‚‰é›¢ã‚Œã‚‹ã»ã©ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªããªã‚‹</strong>ã€ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚Šã€ç¾ã—ã„ã€Œãƒ™ãƒ«ã‚«ãƒ¼ãƒ–ã€ã‚’æãã¾ã™ã€‚</p>
            <h4>èº«è¿‘ãªä¾‹</h4>
            <ul>
                <li>æ—¥æœ¬äººæˆäººç”·æ€§ã®èº«é•·</li>
                <li>å¤§å­¦ã®ãƒ†ã‚¹ãƒˆã®ç‚¹æ•°</li>
                <li>å·¥å ´ã§ä½œã‚‰ã‚Œã‚‹è£½å“ã®é‡ã•ã®ã°ã‚‰ã¤ã</li>
            </ul>
            <p class="instruction">ğŸ‘‡ ã€Œå¹³å‡ã€ã¨ã€Œæ¨™æº–åå·®ã€ã‚’å¤‰ãˆã‚‹ã¨ã€ãƒ™ãƒ«ã‚«ãƒ¼ãƒ–ã®å½¢ã‚„ä½ç½®ãŒã©ã†å¤‰ã‚ã‚‹ã‹è¦³å¯Ÿã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
            <div class="controls">
                <label for="mean">å¹³å‡ (Î¼):</label>
                <input type="number" id="mean" value="100" step="1">
                <label for="stddev">æ¨™æº–åå·® (Ïƒ):</label>
                <input type="number" id="stddev" value="15" min="1" step="1">
                <button onclick="runNormal()">100å€‹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ</button>
                <button onclick="resetChart('normal')">ãƒªã‚»ãƒƒãƒˆ</button>
                <div id="normal-total">ç·ãƒ‡ãƒ¼ã‚¿æ•°: 0</div>
            </div>
            <div class="chart-container">
                <canvas id="normalChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
    // ä»¥å‰ã®JavaScriptã‚³ãƒ¼ãƒ‰ã¨åŒä¸€ã®ãŸã‚ã€ã“ã“ã§ã¯çœç•¥ã—ã¾ã™ã€‚
    // å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€å‰ã®å›ç­”ã®<script>ã‚¿ã‚°å†…ã®ã‚³ãƒ¼ãƒ‰ã‚’
    // ãã®ã¾ã¾ã“ã“ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚
    let charts = {};
    const initialData = {
        uniform: {
            labels: ['1', '2', '3', '4', '5', '6'],
            datasets: [{
                label: 'å‡ºãŸå›æ•°',
                data: [0, 0, 0, 0, 0, 0],
                backgroundColor: 'rgba(54, 162, 235, 0.6)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        binomial: {
            labels: Array.from({length: 11}, (_, i) => i.toString()),
            datasets: [{
                label: 'ã‚»ãƒƒãƒˆæ•°',
                data: Array(11).fill(0),
                backgroundColor: 'rgba(255, 99, 132, 0.6)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            }]
        },
        normal: {
            datasets: [{
                label: 'ç”Ÿæˆãƒ‡ãƒ¼ã‚¿ (ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ )',
                data: [],
                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1,
                barPercentage: 1.0,
                categoryPercentage: 1.0
            }, {
                label: 'ç†è«–ä¸Šã®æ­£è¦åˆ†å¸ƒæ›²ç·š',
                data: [],
                type: 'line',
                borderColor: 'rgba(255, 159, 64, 1)',
                borderWidth: 2,
                fill: false,
                pointRadius: 0
            }]
        }
    };

    function createChart(id, type, data, options) {
        const ctx = document.getElementById(id).getContext('2d');
        if (charts[id.replace('Chart', '')]) {
            charts[id.replace('Chart', '')].destroy();
        }
        charts[id.replace('Chart', '')] = new Chart(ctx, { type, data, options });
    }

    window.onload = function() {
        createChart('uniformChart', 'bar', JSON.parse(JSON.stringify(initialData.uniform)), { scales: { y: { beginAtZero: true, title: { display: true, text: 'å›æ•°' } } }, responsive: true, maintainAspectRatio: false });
        createChart('binomialChart', 'bar', JSON.parse(JSON.stringify(initialData.binomial)), { scales: { y: { beginAtZero: true, title: { display: true, text: 'ã‚»ãƒƒãƒˆæ•°' } }, x: { title: {display: true, text: 'æˆåŠŸå›æ•°'} } }, responsive: true, maintainAspectRatio: false });
        createChart('normalChart', 'bar', JSON.parse(JSON.stringify(initialData.normal)), {
            scales: {
                x: { type: 'linear', beginAtZero: false, title: { display: true, text: 'å€¤' } },
                y: { beginAtZero: true, title: { display: true, text: 'ãƒ‡ãƒ¼ã‚¿æ•°' } }
            },
            responsive: true,
            maintainAspectRatio: false
        });
        normalDataPoints = []; // Reset on load
    };

    function openTab(tabName) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        document.querySelector(`.tab-button[onclick="openTab('${tabName}')"]`).classList.add('active');
    }

    function resetChart(chartName) {
        const chart = charts[chartName];
        if (chartName === 'uniform') {
            chart.data.datasets[0].data.fill(0);
            document.getElementById('uniform-total').innerText = `ç·è©¦è¡Œå›æ•°: 0`;
        } else if (chartName === 'binomial') {
            const n = parseInt(document.getElementById('n-trials').value);
            chart.data.labels = Array.from({length: n + 1}, (_, i) => i.toString());
            chart.data.datasets[0].data = Array(n + 1).fill(0);
            document.getElementById('binomial-total').innerText = `ç·ã‚»ãƒƒãƒˆæ•°: 0`;
        } else if (chartName === 'normal') {
            normalDataPoints = [];
            chart.data.datasets[0].data = [];
            chart.data.datasets[1].data = [];
            chart.data.labels = [];
            document.getElementById('normal-total').innerText = `ç·ãƒ‡ãƒ¼ã‚¿æ•°: 0`;
        }
        chart.update();
    }
    
    // --- Simulation Functions ---
    
    function runUniform(times) {
        const chart = charts.uniform;
        const data = chart.data.datasets[0].data;
        for (let i = 0; i < times; i++) {
            const roll = Math.floor(Math.random() * 6);
            data[roll]++;
        }
        const total = data.reduce((a, b) => a + b, 0);
        document.getElementById('uniform-total').innerText = `ç·è©¦è¡Œå›æ•°: ${total}`;
        chart.update();
    }

    function runBinomial() {
        const chart = charts.binomial;
        const n = parseInt(document.getElementById('n-trials').value);
        const p = parseFloat(document.getElementById('p-prob').value);
        
        // Ensure labels and data array are correct size
        if (chart.data.labels.length !== n + 1) {
            chart.data.labels = Array.from({length: n + 1}, (_, i) => i.toString());
            chart.data.datasets[0].data = Array(n + 1).fill(0);
        }
        
        const currentData = chart.data.datasets[0].data;
        
        for (let i = 0; i < 100; i++) {
            let successes = 0;
            for (let j = 0; j < n; j++) {
                if (Math.random() < p) {
                    successes++;
                }
            }
            if (successes <= n) {
                currentData[successes]++;
            }
        }
        
        const total = currentData.reduce((a, b) => a + b, 0);
        document.getElementById('binomial-total').innerText = `ç·ã‚»ãƒƒãƒˆæ•°: ${total}`;
        chart.update();
    }

    let normalDataPoints = [];
    function runNormal() {
        const chart = charts.normal;
        const mean = parseFloat(document.getElementById('mean').value);
        const stddev = parseFloat(document.getElementById('stddev').value);

        if (isNaN(mean) || isNaN(stddev) || stddev <= 0) {
            alert("æœ‰åŠ¹ãªå¹³å‡å€¤ã¨æ­£ã®æ¨™æº–åå·®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
            return;
        }

        for (let i = 0; i < 100; i++) {
            let u1 = Math.random();
            let u2 = Math.random();
            let z = Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(2.0 * Math.PI * u2);
            normalDataPoints.push(z * stddev + mean);
        }

        const binCount = Math.max(10, Math.floor(Math.sqrt(normalDataPoints.length)));
        const dataMin = Math.min(...normalDataPoints);
        const dataMax = Math.max(...normalDataPoints);
        
        const binWidth = (dataMax - dataMin) / binCount;
        const bins = new Array(binCount).fill(0);
        const labels = new Array(binCount);

        for(let i=0; i<binCount; i++){
            labels[i] = (dataMin + i * binWidth).toFixed(1);
        }
        
        normalDataPoints.forEach(point => {
            let binIndex = Math.floor((point - dataMin) / binWidth);
            if (binIndex >= binCount) binIndex = binCount - 1;
            if (binIndex >= 0) bins[binIndex]++;
        });

        chart.data.labels = labels;
        chart.data.datasets[0].data = bins;
        
        const curveData = [];
        const pdf = (x, mu, sigma) => (1 / (sigma * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2));
        const scaleFactor = normalDataPoints.length * binWidth;
        
        for (let i = 0; i < binCount; i++) {
            const x = dataMin + i * binWidth;
            curveData.push({x: x.toFixed(1), y: pdf(x, mean, stddev) * scaleFactor});
        }
        
        chart.data.datasets[1].data = curveData;

        document.getElementById('normal-total').innerText = `ç·ãƒ‡ãƒ¼ã‚¿æ•°: ${normalDataPoints.length}`;
        chart.update();
    }

    document.getElementById('n-trials').addEventListener('change', () => resetChart('binomial'));
    document.getElementById('mean').addEventListener('change', () => resetChart('normal'));
    document.getElementById('stddev').addEventListener('change', () => resetChart('normal'));
</script>
</body>
</html>

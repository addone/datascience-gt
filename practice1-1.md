# Excel演習：ガチャの「沼」を可視化する ～幾何分布の理解～

## 演習の目的

「成功するまで繰り返す」試行から得られるデータを用いて、その分布の特徴を**度数分布表**と**ヒストグラム**で可視化するスキルを習得する。

この演習を通じて、多くの成功が早い段階で起こる一方で、稀に非常に多くの試行回数がかかってしまう「ロングテール」を持つ**幾何分布**の性質を直感的に理解する。

## シナリオと利用データ

ある大学のオンラインイベントで、参加者全員が景品（大学のオリジナルキャラクターのレア壁紙）が当たるまで、1日1回オンラインガチャを引ける企画が実施された。

以下のデータは、参加した学生40名が、それぞれ何回目の挑戦でレア壁紙を当てたかを示した記録である。

**データ (挑戦回数):**
`1, 3, 1, 2, 5, 1, 8, 2, 1, 4, 15, 1, 2, 6, 1, 4, 9, 3, 1, 7, 11, 2, 1, 22, 5, 2, 1, 3, 10, 4, 6, 1, 3, 1, 18, 2, 5, 1, 7, 3`

---

## 作成手順

### ステップ1：データ入力

1.  新しいExcelシートを開き、A列に「挑戦回数」という見出しをつけます。
2.  A2セルからA41セルに、上記の40人分のデータを入力します。



### ステップ2：階級（区間）の設定

ヒストグラムの横軸となる「階級（Bin）」を設定します。今回は2回刻みで区切ってみましょう。

1.  C列に「階級（上限値）」という見出しをつけます。
2.  C2セルから下に、`2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22` と入力します。
    * **ポイント**: Excelでは階級の**上限値**を指定します。例えば「4」と入力すると、「2を超えて4以下のデータ」がこの階級に含まれます。

### ステップ3：データ分析ツールで度数分布表とヒストグラムを作成

Excelの「データ分析ツール」を使って、度数分布表とヒストグラムを自動作成します。

1.  **「データ分析ツール」の有効化（初回のみ）**
    * `ファイル` > `オプション` > `アドイン` > `設定`と進み、「分析ツール」にチェックを入れます。
    * [Macの場合](https://support.microsoft.com/ja-jp/office/分析ツールを使用して統計学的および工学的分析を行う-6c67ccf0-f4a9-487c-8dec-bdb5a2cefab6)：`データ` タブの `分析` グループで `データ分析` をクリックします。 `データ分析` が表示されない場合は、分析ツール アドイン プログラムを読み込む必要があります。

2.  **ヒストグラム機能の実行**
    * `データ`タブ > `データ分析` をクリックします。
    * `ヒストグラム`を選択し、「OK」をクリックします。
    * 表示されたウィンドウで、以下のように設定します。
        * **入力範囲:** `$A$1:$A$41` （挑戦回数データの範囲、見出しも含む）
        * **データ区間:** `$C$1:$C$11` （階級データの範囲、見出しも含む）
        * **ラベル:** チェックを入れる
        * **出力先:** `E1` セルなどを指定
        * **グラフ作成:** **必ずチェックを入れる**
    * 「OK」をクリックします。



### ステップ4：ヒストグラムの整形

自動作成されたグラフを、より分かりやすいヒストグラムに整形します。

1.  **棒の隙間をなくす**
    * グラフの青い棒を右クリック > 「データ系列の書式設定」を選択。
    * 「系列のオプション」で**「要素の間隔」を `0%`** にします。
2.  **見出しと軸ラベルの修正**
    * グラフタイトルを「レア壁紙獲得までの挑戦回数分布」などに変更します。
    * 横軸のタイトルを「挑戦回数」、縦軸のタイトルを「人数（度数）」に変更します。
3.  **枠線の追加**
    * 棒グラフの「枠線」を「線（単色）」の黒などに設定すると、区切りが見やすくなります。



---

## 考察：このグラフから何がわかるか？

完成したヒストグラムを見て、以下の点について考え、幾何分布の重要性を理解しましょう。

* **分布の形:** グラフはどのような形をしていますか？
    * 最も人数の多い階級はどこでしょうか。多くの学生は早い段階で成功していることがわかります。
    * グラフの右側（挑戦回数が多い方）はどうなっていますか？人数は少ないですが、非常に運悪く、多くの回数がかかった学生もいることがわかります。このような**右側に裾の長い（右に歪んだ）分布**が、幾何分布の典型的な特徴です。

* **平均値の罠:**
    * このデータの平均値（AVERAGE関数で計算できます）は、中央値（MEDIAN関数）や最頻値（MODE.SNGL関数）と比べてどうなっていますか？
    * 一部の「非常に運が悪かった人」のデータが、全体の平均値を引き上げていることが確認できます。イベントの運営者は、「平均的には5回くらいで当たるだろう」と想定していても、20回以上かかってしまう参加者へのケアが必要になるかもしれない、と予測できます。

* **幾何分布の重要性:**
    * このような分布は、「営業で初めて契約が取れるまでの訪問回数」「製品が故障するまでの使用回数」など、ビジネスや品質管理の世界でも頻繁に現れます。
    * 「ほとんどは早く成功するが、ごく稀に大きなコスト（時間・回数）がかかる」という事象を正しくモデル化し、リスクを予測するために、幾何分布の理解は非常に重要なのです。

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ã®ä»•çµ„ã¿ã‚’ç†è§£ã—ã‚ˆã†</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #f97316;
            --bg: #f3f4f6;
            --text: #1f2937;
            --card-bg: #ffffff;
        }
        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
        }
        .wrapper {
            max-width: 900px;
            margin: 0 auto;
        }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--primary);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        header h1 { margin: 0; font-size: 1.8em; }
        header p { margin-top: 10px; opacity: 0.9; }

        /* ã‚«ãƒ¼ãƒ‰ï¼ˆè§£èª¬ãƒ»ãƒ„ãƒ¼ãƒ«éƒ¨åˆ†ï¼‰ */
        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            border-left: 5px solid var(--primary);
        }
        .card.interactive {
            border-left-color: var(--secondary);
            background-color: #fffaf0; /* å°‘ã—è‰²ã‚’å¤‰ãˆã¦å®Ÿè·µãƒ‘ãƒ¼ãƒˆã ã¨åˆ†ã‹ã‚‹ã‚ˆã†ã« */
        }

        h2 { border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; color: #111827; }
        h3 { color: var(--primary); margin-top: 20px; }
        
        .highlight {
            background: #e0e7ff;
            color: #3730a3;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        /* ãƒ„ãƒ¼ãƒ«UI */
        textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            resize: vertical;
            transition: border-color 0.3s;
        }
        textarea:focus { border-color: var(--secondary); outline: none; }

        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: transform 0.1s, background 0.3s;
            box-shadow: 0 4px 6px rgba(249, 115, 22, 0.3);
        }
        .btn:hover { background-color: #ea580c; transform: translateY(-2px); }
        .btn:active { transform: translateY(0); }

        /* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        #result-area { display: none; animation: fadeIn 0.5s ease-out; }
        
        /* å˜èªãƒãƒƒãƒ— */
        #token-box {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 15px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            min-height: 60px;
        }
        .token {
            padding: 4px 10px;
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 20px;
            font-size: 14px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            opacity: 0;
            transform: scale(0.5);
        }
        .token.noun { border-color: var(--primary); color: var(--primary); font-weight: bold; background: #eff6ff; }
        .token.ignore { opacity: 0.5; background: #e5e7eb; border-color: transparent; text-decoration: line-through; color: #9ca3af; }

        /* ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã‚°ãƒ©ãƒ•ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) { .analysis-grid { grid-template-columns: 1fr; } }

        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; border-bottom: 1px solid #e5e7eb; text-align: left; }
        th { background: #f3f4f6; font-size: 0.9em; }
        tr:first-child td { font-weight: bold; color: var(--secondary); }

        @keyframes popIn { to { opacity: 1; transform: scale(1); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .tip-box {
            background-color: #ecfdf5;
            border: 1px solid #10b981;
            color: #065f46;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.95em;
        }
    </style>
</head>
<body>

<div class="wrapper">
    <header>
        <h1>ãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°å…¥é–€ â›ï¸</h1>
        <p>ã€Œè¨€è‘‰ã®å±±ã€ã‹ã‚‰ã€Œå®ï¼ˆä¾¡å€¤ã‚ã‚‹æƒ…å ±ï¼‰ã€ã‚’æ˜ã‚Šå‡ºã™æŠ€è¡“</p>
    </header>

    <div class="card">
        <h2>1. ãªãœãƒ†ã‚­ã‚¹ãƒˆãƒã‚¤ãƒ‹ãƒ³ã‚°ãŒå¿…è¦ï¼Ÿ</h2>
        <p>è¦³å…‰åœ°ã«ã¯ã€SNSã®æŠ•ç¨¿ã€ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã®è‡ªç”±è¨˜è¿°ã€äºˆç´„ã‚µã‚¤ãƒˆã®å£ã‚³ãƒŸãªã©ã€è†¨å¤§ãªã€Œæ–‡ç« ãƒ‡ãƒ¼ã‚¿ã€ãŒæº¢ã‚Œã¦ã„ã¾ã™ã€‚</p>
        <p>ã“ã‚Œã‚‰ã‚’äººé–“ãŒå…¨ã¦èª­ã‚€ã®ã¯ä¸å¯èƒ½ã§ã™ã€‚ãã“ã§ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦æ–‡ç« ã‚’åˆ†æã—ã€<strong>ã€Œã¿ã‚“ãªãŒä½•ã«é–¢å¿ƒã‚’æŒã£ã¦ã„ã‚‹ã‹ã€</strong>ã‚’è‡ªå‹•ã§é›†è¨ˆã™ã‚‹æŠ€è¡“ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚</p>
    </div>

    <div class="card interactive">
        <h2>2. ã€å®Ÿé¨“ã€‘ ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«æ–‡ç« ã‚’èª­ã¾ã›ã¦ã¿ã‚ˆã†</h2>
        <p>ä»¥ä¸‹ã®ãƒœãƒƒã‚¯ã‚¹ã«åˆ†æã—ãŸã„æ–‡ç« ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ï¼ˆåˆæœŸå€¤ã¨ã—ã¦ã‚µãƒ³ãƒ—ãƒ«ã®è¦³å…‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå…¥ã£ã¦ã„ã¾ã™ï¼‰</p>
        <textarea id="inputText" placeholder="ã“ã“ã«åˆ†æã—ãŸã„æ–‡ç« ã‚’å…¥åŠ›...">äº¬éƒ½ã®å¯ºé™¢ã¯ã¨ã¦ã‚‚é™ã‹ã§å¿ƒãŒè½ã¡ç€ãã¾ã—ãŸã€‚ç‰¹ã«é‡‘é–£å¯ºã®è¼ãã¯ç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚æŠ¹èŒ¶ã®ã‚¹ã‚¤ãƒ¼ãƒ„ãŒç¾å‘³ã—ãã¦ã€æ¸…æ°´å¯ºã®å‚é“ã§é£Ÿã¹ãŸå…«ãƒƒæ©‹ã‚‚æœ€é«˜ã§ã—ãŸã€‚ãƒã‚¹ã¯æ··ã‚“ã§ã„ã¾ã—ãŸãŒã€é‹è»¢æ‰‹ã•ã‚“ã¯è¦ªåˆ‡ã§ã—ãŸã€‚</textarea>
        <button class="btn" onclick="startAnalysis()">åˆ†æã‚¹ã‚¿ãƒ¼ãƒˆ ğŸš€</button>
    </div>

    <div id="result-area">
        <div class="card">
            <h2>3. ä»•çµ„ã¿â‘ ï¼šå½¢æ…‹ç´ è§£æï¼ˆã‘ã„ãŸã„ãã‹ã„ã›ãï¼‰</h2>
            <p>ç§ãŸã¡äººé–“ã¯ã€Œäº¬éƒ½ã®å¯ºé™¢ã€ã‚’è¦‹ã‚Œã°ã€ã€Œäº¬éƒ½ / ã® / å¯ºé™¢ã€ã¨ã„ã†æ„å‘³ã®åŒºåˆ‡ã‚ŠãŒè‡ªç„¶ã«ã‚ã‹ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ã¯ãŸã ã®æ–‡å­—ã®ç¾…åˆ—ã«ã—ã‹è¦‹ãˆã¾ã›ã‚“ã€‚</p>
            <p>ãã“ã§ã€è¾æ›¸ã‚’ä½¿ã£ã¦æ–‡ç« ã‚’æœ€å°å˜ä½ï¼ˆå˜èªï¼‰ã«ãƒãƒ©ãƒãƒ©ã«ã™ã‚‹å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚ã“ã‚Œã‚’<span class="highlight">å½¢æ…‹ç´ è§£æ</span>ã¨å‘¼ã³ã¾ã™ã€‚</p>
            
            <h3>å®Ÿéš›ã®åˆ†è§£çµæœ</h3>
            <p>â€»åˆ†æã«é‡è¦ãªã€Œåè©ã€ãªã©ã¯é’è‰²ã€æ„å‘³ã®è–„ã„ã€ŒåŠ©è©ï¼ˆã¦ã€ã«ã€ã‚’ã€ã¯ï¼‰ã€ãªã©ã¯ã‚°ãƒ¬ãƒ¼ã§è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>
            <div id="token-box"></div>

            <div class="tip-box">
                <strong>ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆï¼šã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰ï¼ˆä¸è¦èªï¼‰</strong><br>
                ã€Œã®ã€ã€Œã¯ã€ã€Œã§ã™ã€ãªã©ã¯ã€ã©ã‚“ãªæ–‡ç« ã«ã‚‚é »ç¹ã«å‡ºã¦ãã‚‹ãŸã‚ã€åˆ†æã®é‚ªé­”ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã‚’æ„å›³çš„ã«ç„¡è¦–ã™ã‚‹ã“ã¨ã‚’ã€Œã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰ã®é™¤å»ã€ã¨å‘¼ã³ã¾ã™ã€‚
            </div>
        </div>

        <div class="card">
            <h2>4. ä»•çµ„ã¿â‘¡ï¼šå®šé‡åŒ–ï¼ˆè¨€è‘‰ã‚’æ•°ãˆã‚‹ï¼‰</h2>
            <p>ãƒãƒ©ãƒãƒ©ã«ã—ãŸå˜èªã‚’æ•°ãˆä¸Šã’ã‚‹ã“ã¨ã§ã€<strong>ã€Œã©ã®è¨€è‘‰ãŒé‡è¦ãªã®ã‹ã€</strong>ã‚’æ•°å€¤ï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼‰ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
            
            <div class="analysis-grid">
                <div>
                    <h3>ğŸ“Š å‡ºç¾å›æ•°ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3>
                    <table id="ranking-table">
                        <thead><tr><th>é †ä½</th><th>å˜èª</th><th>å›æ•°</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div>
                    <h3>ğŸ“ˆ ã‚°ãƒ©ãƒ•ã«ã‚ˆã‚‹å¯è¦–åŒ–</h3>
                    <canvas id="myChart"></canvas>
                </div>
            </div>
            
            <p style="margin-top:20px;">
                ã“ã®çµæœã‚’è¦‹ã‚‹ã“ã¨ã§ã€ã€Œäº¬éƒ½ã€ã¨ã„ã†å…¨ä½“ãƒ†ãƒ¼ãƒã®ä¸­ã§ã€ç‰¹ã«<strong>ã€Œå¯ºé™¢ã€ã€Œé‡‘é–£å¯ºã€ã€ŒæŠ¹èŒ¶ã€</strong>ãªã©ãŒè©±é¡Œã®ä¸­å¿ƒã§ã‚ã‚‹ã“ã¨ãŒä¸€ç›®ã§ã‚ã‹ã‚Šã¾ã™ã€‚ï¼ˆâ†ã»ã¨ã‚“ã©ã®å ´åˆã¯ãã‚“ãªè‰¯ã„çµæœãŒå‡ºãªã„ã€‚ï¼‰
            </p>
        </div>

        <div class="card interactive">
            <h2>ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼šè‡ªåˆ†ã®è¨€è‘‰ã§è©¦ãã†</h2>
            <p>ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã®å…¥åŠ›ãƒœãƒƒã‚¯ã‚¹ã«æˆ»ã‚Šã€ä»¥ä¸‹ã®æ–‡ç« ã‚’ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ã€çµæœãŒã©ã†å¤‰ã‚ã‚‹ã‹è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
            <ul>
                <li>è‡ªåˆ†ãŒæœ€è¿‘è¡Œã£ãŸæ—…è¡Œã®æ„Ÿæƒ³</li>
                <li>å¥½ããªã‚¢ãƒ‹ãƒ¡ã‚„æ˜ ç”»ã®ã‚ã‚‰ã™ã˜</li>
                <li>ä»Šæ—¥ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã®ä¸€éƒ¨</li>
            </ul>
        </div>
    </div>
</div>

<script>
    // ãƒ–ãƒ©ã‚¦ã‚¶ã®æ—¥æœ¬èªè§£ææ©Ÿèƒ½ï¼ˆIntl.Segmenterï¼‰ã‚’ä½¿ç”¨
    // â€»å¤–éƒ¨è¾æ›¸ãªã—ã§å‹•ä½œã™ã‚‹æœ€æ–°ã®Webæ¨™æº–æ©Ÿèƒ½ã§ã™
    const segmenter = new Intl.Segmenter('ja', { granularity: 'word' });

    // ã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰ï¼ˆåˆ†æã‹ã‚‰é™¤å¤–ã™ã‚‹å˜èªï¼‰ã®ãƒªã‚¹ãƒˆ
    const STOP_WORDS = new Set([
        'ã®', 'ã¯', 'ãŒ', 'ã§', 'ã«', 'ã‚’', 'ã¨', 'ã¦', 'ãŸ', 'ã‚‚', 'ã—', 'ã¾ã™', 'ã§ã™', 
        'ã“ã¨', 'ã‚‚ã®', 'ã•ã‚“', 'ã‚ˆã†', 'ãŸã‚', 'ãã‚Œ', 'ã“ã‚Œ', 'ã‚ã‚Œ',
        'ã€‚', 'ã€', 'ãƒ»', 'ï¼', 'ï¼Ÿ', '\n', ' ', 'ã€€'
    ]);

    let chartInstance = null;

    function startAnalysis() {
        const text = document.getElementById('inputText').value;
        if (!text.trim()) {
            alert("æ–‡ç« ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
            return;
        }

        // çµæœã‚¨ãƒªã‚¢ã‚’è¡¨ç¤º
        document.getElementById('result-area').style.display = 'block';
        
        // 1. å½¢æ…‹ç´ è§£æã¨HTMLç”Ÿæˆ
        const tokenBox = document.getElementById('token-box');
        tokenBox.innerHTML = ''; // ã‚¯ãƒªã‚¢
        
        const segments = segmenter.segment(text);
        const counts = {};
        let delay = 0;

        for (const seg of segments) {
            const word = seg.segment;
            const isStopWord = STOP_WORDS.has(word) || word.length < 1; // 1æ–‡å­—æœªæº€ã‚„ã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰

            // 1. ã€è¨ˆç®—ã€‘ã¯ã™ãã«ã‚„ã‚‹ï¼ˆã“ã“ã‚’setTimeoutã®å¤–ã«å‡ºã—ã¾ã—ãŸï¼ï¼‰
            if (!isStopWord) {
                counts[word] = (counts[word] || 0) + 1;
            }

            // HTMLè¦ç´ ä½œæˆï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ï¼‰
            setTimeout(() => {
                const span = document.createElement('span');
                span.textContent = word;
                
                if (isStopWord) {
                    span.className = 'token ignore';
                } else {
                    span.className = 'token noun'; // ç°¡æ˜“çš„ã«å…¨ã¦nounæ‰±ã„ï¼ˆå¼·èª¿ç”¨ï¼‰
                }
                tokenBox.appendChild(span);
            }, delay);
            delay += 30; // 30msã”ã¨ã«è¡¨ç¤º
        }

        // 2. é›†è¨ˆã¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°
        // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é…åˆ—ã«å¤‰æ›ã—ã¦ã‚½ãƒ¼ãƒˆ
        const sortedWords = Object.entries(counts)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 8); // ä¸Šä½8ä»¶ã®ã¿

        // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
        const tbody = document.querySelector('#ranking-table tbody');
        tbody.innerHTML = '';
        sortedWords.forEach((item, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${index + 1}ä½</td><td>${item[0]}</td><td>${item[1]}å›</td>`;
            tbody.appendChild(tr);
        });

        // 3. ã‚°ãƒ©ãƒ•æ›´æ–°
        updateChart(sortedWords);

        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆçµæœãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ï¼‰
        setTimeout(() => {
            document.getElementById('result-area').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 300);
    }

    function updateChart(data) {
        const ctx = document.getElementById('myChart').getContext('2d');
        
        if (chartInstance) {
            chartInstance.destroy();
        }

        chartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: data.map(d => d[0]),
                datasets: [{
                    label: 'å‡ºç¾å›æ•°',
                    data: data.map(d => d[1]),
                    backgroundColor: 'rgba(37, 99, 235, 0.6)',
                    borderColor: 'rgba(37, 99, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, ticks: { stepSize: 1 } }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });
    }
</script>

</body>
</html>
